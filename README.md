# readable.py


概要:
--------
このスクリプトは、指定されたフォルダ内のPDFファイルを自動で処理し、指定された条件に従って分割や結合を行います。
Selenium WebDriverを使用して、PDFファイルをオンライン翻訳サービス「readable.jp」にアップロードし、翻訳されたPDFをダウンロードします。

機能:
--------
1. PDFファイルのリストアップと分割:
   - カレントディレクトリ内のPDFファイルをリストアップし、ページ数またはファイルサイズが指定の条件を超える場合に、PDFを分割します。
   - 分割されたPDFは、新しいファイルとして保存されます。

2. Chromeプロセスの管理:
   - 実行中のChromeタスクがあれば、自動的に終了させます。
   - Chromeのユーザープロファイルを指定して、Selenium WebDriverを起動します。

3. PDFのアップロードとダウンロード:
   - PDFファイルを並行してオンラインサービス「readable.jp」にアップロードします。
   - 翻訳されたPDFファイルをダウンロードし、カレントディレクトリに保存します。

4. PDFの結合:
   - "_part"が含まれるPDFファイルをグループ化し、元の名前に基づいて結合します。
   - 結合後、元の部分ファイルは削除されます。

5. 古いファイルの管理:
   - ダウンロード後5時間以内に取得したファイルをカレントディレクトリに移動します。
   - 不要な"_part"ファイルも削除します。

使用方法:
-----------
0. ライブラリ
```bash
pip install chromedriver-binary selenium PyPDF2

```
1. Chromeのユーザープロファイル:
   - ユーザープロファイルは、`C:/Users/butsu/AppData/Local/Google/Chrome/User Data/Profile 11`に設定されています。自身の環境で使用する場合は、現在使用しているプロファイルを確認するため、Chrome の URL欄にchrome://versionと入れます。「プロフィールパス」から使用中のプロファイルの場所と名前を確認することができます。下記の部分を変更してください.
   ```python
   chrome_options.add_argument(f"user-data-dir=C:/Users/butsu/AppData/Local/Google/Chrome/User Data")
   chrome_options.add_argument("profile-directory=Profile 11")
    ```
2. PDFファイルの処理:
   - スクリプトは、カレントディレクトリにあるすべてのPDFファイルを対象とします。
   - 分割するPDFは、ページ数が100ページを超えるか、ファイルサイズが50MBを超える場合に処理されます。

3. 実行手順:
   - スクリプトを実行することで、PDFファイルの分割、アップロード、ダウンロード、結合が自動的に行われます。

注意点:
--------
- このスクリプトはSeleniumとChromeDriverを使用しますので、事前にChromeDriverのパスを設定し、Seleniumをインストールしてください。
- タイムアウトや接続エラーが発生する場合は、ネットワーク環境やSeleniumの設定を確認してください。

ライセンス:
-----------
このスクリプトは自由に使用、変更、再配布可能です。商用利用も許可されますが、自己責任でご利用ください。

********************************************************************************